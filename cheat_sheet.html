<!DOCTYPE html>
<html lang="en">
	<title>Alon's Vim Cheat Sheet</title>
	<link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
	<script type="module">
		import { render } from 'https://unpkg.com/preact@latest?module';
		import { html } from 'https://unpkg.com/htm@3.0.4/preact/index.module.js?module';
		import { useState, useEffect } from 'https://unpkg.com/preact@latest/hooks/dist/hooks.module.js?module'

		function csvToObjects(s) {
			const lines = s.split("\n");
			const header = lines.shift().split(",");
			return lines.map((l) => {
				const parts = l.split(",");
				const ret = {};
				parts.forEach((part, index) => {
					ret[header[index]] = part.trim();
				});
				return ret;
			});
		}

		function App({ name }) {
		  const [shortcuts, setShortcuts] = useState([]);

		  useEffect(async () => {
			  // Get shortcuts data
			  const response = await fetch(`${window.location.origin}/shortcuts.csv`);
			  const csvData = await response.text();
			  const newShortcuts = csvToObjects(csvData);
			  setShortcuts(newShortcuts);
		  }, []);

		  return html`
		  <div class="app">
			 <h1 class="text-2xl text-center text-blue-600">Alon's Vim Cheat Sheet</h1>
			 <div class="grid grid-cols-3">
				 ${shortcuts.map((shortcut) => html`
					
					 <div class="flex items-center text-lg bg-green-100 p-4 m-2">
						 <div class="font-mono bg-gray-200">
							 ${shortcut.keybind}
						 </div>
						 - ${shortcut.description}
					 </div>
				 `)}
			 </div>
		  </div>
		  `;
		}

		render(html`<${App} />`, document.body);
	</script>
</html>
